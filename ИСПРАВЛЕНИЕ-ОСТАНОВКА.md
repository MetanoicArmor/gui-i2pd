# ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ daemon

## ‚ùå –ü—Ä–æ–±–ª–µ–º–∞
–ö–æ–º–∞–Ω–¥–∞ `--kill` –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –±–∏–Ω–∞—Ä–Ω–∏–∫–æ–º i2pd:
```
args: unrecognised option '--kill'
```

## üîç –ê–Ω–∞–ª–∏–∑ —Å–∏—Ç—É–∞—Ü–∏–∏

1. **–ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è i2pd:**
   - –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ `--daemon` –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –≤ —Ñ–æ–Ω–µ
   - –û–ø—Ü–∏—è `--kill` –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
   - –ï—Å—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —É–∫–∞–∑–∞—Ç—å PID —Ñ–∞–π–ª —Å `--pidfile`

2. **–û–±–Ω–∞—Ä—É–∂–µ–Ω–æ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:**
   - i2pd –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø—Ä–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–µ —á–µ—Ä–µ–∑ —Å–∏–≥–Ω–∞–ª—ã
   - –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–≤—è–∑–∞–Ω–æ —Å —Å–∏—Å—Ç–µ–º–æ–π —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ—Ä–≤–∏—Å–∞–º–∏ macOS

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

–û–±–Ω–æ–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `stopDaemon()` –≤ `I2pdManager.swift`:

### üîß –ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏:

```swift
private func stopDaemonProcess() {
    // 1. –ò—â–µ–º PID —Ñ–∞–π–ª i2pd
    let pidPaths = [
        "\(NSHomeDirectory())/i2pd/i2pd.pid",
        "/var/lib/i2pd/i2pd.pid", 
        "\(Bundle.main.bundlePath)/i2pd.pid"
    ]
    
    // 2. –ò—Å–ø–æ–ª—å–∑—É–µ–º SIGTERM, –∑–∞—Ç–µ–º SIGKILL –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
    let command = "pkill -TERM -f i2pd && sleep 2 && pkill -KILL -f i2pd 2>/dev/null || true"
}
```

### üìã –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –∫–æ–º–∞–Ω–¥—ã:

**–ó–∞–ø—É—Å–∫:**
```bash
./i2pd-gui/i2pd --daemon
```

**–û—Å—Ç–∞–Ω–æ–≤–∫–∞ (–æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –º–µ—Ç–æ–¥):**
```bash
pkill -TERM -f i2pd     # –ú—è–≥–∫–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞
pkill -KILL -f i2pd     # –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞:**
```bash
pgrep -f i2pd           # –ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–æ—Ü–µ—Å ID
ps aux | grep i2pd      # –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
```

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

‚úÖ **–£–±—Ä–∞–Ω–∞ –Ω–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–∞—è –æ–ø—Ü–∏—è `--kill`**  
‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ —á–µ—Ä–µ–∑ —Å–∏–≥–Ω–∞–ª—ã**  
‚úÖ **–ö–æ–¥ —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫**  
‚úÖ **–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é**  

## ‚ö†Ô∏è –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ

–ï—Å–ª–∏ i2pd –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è, —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–≤—è–∑–∞–Ω–æ —Å:

1. **LaunchDaemon** - —Å–∏—Å—Ç–µ–º–æ–π –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞ macOS
2. **–í–Ω–µ—à–Ω–∏–º –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º –ø—Ä–æ—Ü–µ—Å—Å–æ–≤**
3. **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π —Å–∞–º–æ–≥–æ i2pd**

–í —Ç–∞–∫–∏—Ö —Å–ª—É—á–∞—è—Ö –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è:
- –û—Ç–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫ –≤ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ—Ä–≤–∏—Å–∞–º–∏: `launchctl unload`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã i2pd

## üöÄ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è i2pd daemon!
