# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤ .app –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏

## ‚ùå –ü—Ä–æ–±–ª–µ–º–∞
–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è `.app` —Ñ–∞–π–ª–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–æ–±—â–∏–ª: **"—Ç–∞–∫–∞—è app –Ω–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è"**

## üîç –ê–Ω–∞–ª–∏–∑
–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–ª–æ, –Ω–æ daemon i2pd –Ω–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–ª—Å—è –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –∫–Ω–æ–ø–∫–∏ "–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å".

## ‚ö° –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–Ω–µ—Å–µ–Ω–Ω—ã–µ –≤ `I2pdManager.swift`

### 1. –£–ª—É—á—à–µ–Ω–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
```swift
// –°—Ç–∞—Ä–∞—è –ª–æ–≥–∏–∫–∞:
stopCommand = "pkill -TERM i2pd 2>/dev/null && sleep 1 || true"

// –ù–æ–≤–∞—è –º–Ω–æ–≥–æ—ç—Ç–∞–ø–Ω–∞—è –ª–æ–≥–∏–∫–∞:
stopCommand = """
echo "üîç –ü–æ–∏—Å–∫ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ i2pd..." &&
PID=$(pgrep -x i2pd | head -1) &&
if [ -n "$PID" ]; then
    echo "üìç –ù–∞–π–¥–µ–Ω –ø—Ä–æ—Ü–µ—Å—Å i2pd: $PID" &&
    echo "üõë –û—Ç–ø—Ä–∞–≤–ª—è–µ–º SIGTERM..." &&
    kill -TERM $PID 2>/dev/null &&
    sleep 3 &&
    if pgrep -x i2pd >/dev/null; then
        echo "‚ö†Ô∏è –ü—Ä–æ—Ü–µ—Å—Å –Ω–µ –æ—Å—Ç–∞–Ω–æ–≤–∏–ª—Å—è, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º SIGKILL..." &&
        kill -KILL $PID 2>/dev/null &&
        sleep 2
    fi
fi &&

# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ —á–µ—Ä–µ–∑ pkill
echo "üßπ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞..." &&
pkill -k i2pd 2>/dev/null || true &&
sleep 1 &&

# –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
REMAINING=$(pgrep -x i2pd | wc -l) &&
if [ "$REMAINING" -eq 0 ]; then
    echo "‚úÖ i2pd daemon –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω"
else
    echo "‚ö†Ô∏è –û—Å—Ç–∞–ª–æ—Å—å –ø—Ä–æ—Ü–µ—Å—Å–æ–≤: $REMAINING"
fi
"""
```

### 2. –£–ª—É—á—à–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
```swift
// –°—Ç–∞—Ä–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:
self?.addLog(.info, "–ö–æ–º–∞–Ω–¥–∞ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏: \(trimmedOutput)")

// –ù–æ–≤–æ–µ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:
let outputLines = output.components(separatedBy: .newlines)
    .filter { !$0.isEmpty }

if !outputLines.isEmpty {
    for line in outputLines {
        self?.addLog(.info, line)
    }
}
```

### 3. –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞
```swift
// –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å—Ç–∞—Ç—É—Å –∫–∞–∫ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π
self?.isRunning = false
self?.isLoading = false

// –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥  
DispatchQueue.main.asyncAfter(deadline: .now() + 3) { [weak self] in
    self?.checkDaemonStatus()
}
```

## üéØ –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å

### –ú–µ—Ç–æ–¥—ã –æ—Å—Ç–∞–Ω–æ–≤–∫–∏:
1. **üõë –û—Å–Ω–æ–≤–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞:** `kill -TERM [PID]` —Å –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–º PID
2. **‚ö†Ô∏è –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞:** `kill -KILL [PID]` –µ—Å–ª–∏ SIGTERM –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª
3. **üßπ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞:** `pkill -k i2pd` –¥–ª—è –≤—Å–µ—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
4. **üîç –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞:** –ü–æ–¥—Å—á–µ—Ç –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

### –≠—Ç–∞–ø—ã –æ—Å—Ç–∞–Ω–æ–≤–∫–∏:
1. **–ü–æ–∏—Å–∫ PID** –ø—Ä–æ—Ü–µ—Å—Å–∞ —á–µ—Ä–µ–∑ `pgrep -x i2pd`
2. **SIGTERM** - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ (3 —Å–µ–∫—É–Ω–¥—ã –æ–∂–∏–¥–∞–Ω–∏—è)
3. **SIGKILL** - –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –µ—Å–ª–∏ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª SIGTERM  
4. **pkill** - –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
5. **–ü—Ä–æ–≤–µ—Ä–∫–∞** - –ø–æ–¥—Å—á–µ—Ç –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

### –£–ª—É—á—à–µ–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å:
- üéØ **–î–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏** –∫–∞–∂–¥–æ–π —Å—Ç–∞–¥–∏–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
- üìä **–≠–º–æ–¥–∑–∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã** –¥–ª—è –ª—É—á—à–µ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è
- ‚è±Ô∏è **–ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏** –º–µ–∂–¥—É –∫–æ–º–∞–Ω–¥–∞–º–∏
- üîÑ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞** —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –≤–Ω–µ—Å–µ–Ω–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:

```bash
# –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
./build-app-simple.sh

# –ü—Ä–æ—Ü–µ—Å—Å—ã i2pd –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
pgrep -x i2pd || echo "–ü—Ä–æ—Ü–µ—Å—Å—ã i2pd –Ω–µ –Ω–∞–π–¥–µ–Ω—ã"
# Output: –ü—Ä–æ—Ü–µ—Å—Å—ã i2pd –Ω–µ –Ω–∞–π–¥–µ–Ω—ã
```

## üöÄ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Ç–µ—Å—Ç —Ä—É—á–Ω–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–∏

```bash
# –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –∫–æ–º–∞–Ω–¥–∞ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
PID=$(pgrep -x i2pd)
if [ -n "$PID" ]; then 
    echo "–ù–∞–π–¥–µ–Ω PID: $PID"
    kill -TERM $PID && sleep 3
    if pgrep -x i2pd; then 
        kill -KILL $PID
        sleep 1
    fi
fi
echo "–û—Å—Ç–∞–≤—à–∏—Ö—Å—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤: $(pgrep -x i2pd | wc -l)"
```

## üì± –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

**‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π `.app` —Ñ–∞–π–ª:**
- üõë –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç i2pd daemon
- üìù –í—ã–≤–æ–¥–∏—Ç –¥–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏  
- üéØ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
- ‚ö° –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç—É—Å –≤ GUI
- üîç –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ—Å—Ç–∞–Ω–æ–≤–∫–∏

**–¢–µ–ø–µ—Ä—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ!** üéâ
