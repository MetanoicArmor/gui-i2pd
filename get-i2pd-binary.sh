#!/bin/bash

echo "üîç –ó–∞–≥—Ä—É–∑–∫–∞ –±–∏–Ω–∞—Ä–Ω–∏–∫–∞ i2pd –¥–ª—è macOS"
echo "====================================="

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É
ARCH=$(uname -m)
echo "üì± –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: $ARCH"

if [[ "$ARCH" == "arm64" ]]; then
    echo "üçé Apple Silicon (ARM64) detected"
elif [[ "$ARCH" == "x86_64" ]]; then
    echo "üíª Intel Mac (x86_64) detected"
else
    echo "‚ùå –ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: $ARCH"
    exit 1
fi

# URL –æ—Ç–∫—É–¥–∞ —Å–∫–∞—á–∏–≤–∞—Ç—å (–Ω—É–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π)
I2PD_URL="https://github.com/PurpleI2P/i2pd/releases/latest/download/i2pd_2.58.0_darwin_$ARCH.tar.gz"
I2PD_DIR="./i2pd-src"

echo "üì• –ó–∞–≥—Ä—É–∂–∞–µ–º i2pd..."
echo "URL: $I2PD_URL"

# –°–æ–∑–¥–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
mkdir -p "$I2PD_DIR"
cd "$I2PD_DIR"

# –ó–∞–≥—Ä—É–∂–∞–µ–º (–∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ, —Ç–∞–∫ –∫–∞–∫ –Ω—É–∂–µ–Ω —Ä–µ–∞–ª—å–Ω—ã–π URL)
echo "‚ö†Ô∏è –î–ª—è —Ä–∞–±–æ—Ç—ã –Ω—É–∂–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ä–µ–∞–ª—å–Ω—ã–π –±–∏–Ω–∞—Ä–Ω–∏–∫ i2pd"
echo "üìç –ü–æ–º–µ—Å—Ç–∏—Ç–µ –±–∏–Ω–∞—Ä–Ω–∏–∫ 'i2pd' –≤ –∫–æ—Ä–µ–Ω—å –ø—Ä–æ–µ–∫—Ç–∞"

echo "‚úÖ –°–∫—Ä–∏–ø—Ç –∑–∞–≤–µ—Ä—à–µ–Ω!"
